http_port 3128

# No disk caching
cache deny all
cache_mem 8 MB
coredump_dir /tmp

# ACLs
acl SSL_ports port 443
acl CONNECT method CONNECT
acl whitelist dstdomain "/etc/squid/whitelist.conf"

# Only allow CONNECT tunnels to HTTPS ports
http_access deny CONNECT !SSL_ports

# Allow whitelisted domains (HTTPS and HTTP)
http_access allow CONNECT whitelist
http_access allow whitelist

# Deny everything else
http_access deny all

# Log to stdout/stderr for docker logs
access_log stdio:/dev/stdout
cache_log stdio:/dev/stderr
